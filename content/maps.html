---
body_id: maps
header: |
  <script src="http://bxslider.com/sites/default/files/jquery.bxSlider.min.js" type="text/javascript"></script>
  <script>

  $(function(){
    // assign the slider to a variable
    var slider = $('#slider').bxSlider({
      controls: false
      });

      var setLocation = function(location) {
      $('#slider-aside h1').html(location);
      }

      var setPdf = function(pdf, pdf_size) {

      // change this
      var pdf = "http://www.gpsies.com/map.do?fileId=drgkazfuaufzrdro&amp;referrer=trackList";
      //

      $('#slider-aside p').html('<a href="'+pdf+'" target="_blank">download track' /* ('+pdf_size+') */ + '</a>')
      }

      var setAdditional = function(additional, thumb) {
        if (additional) {
          additional = additional.split(",");
          if (thumb == undefined) thumb = additional;

          var htmlCode = ""
          $.each(additional, function(idx, elem) {
          htmlCode += '<a href="' + elem + '"><img src="' + elem + '" width="120" /></a><br>';
            });
          $('#slider-aside .slider-aside-image').html("<div>" + htmlCode + "</div>");
          $("#slider-aside .slider-aside-image a").colorbox({rel:'group1'});
      } else {
        $('#slider-aside .slider-aside-image div').remove();
      }
      }

    // assign a click event to the external thumbnails
    $('.slider-thumbs a').click(function(){
      var thumbIndex = $(this).data("refid");
      var location = $(this).data("location");
      var additional = $(this).data("additional");
      var additional_thumb = $(this).data("additional_thumb");
      var pdf = $(this).data("pdf");
      var pdf_size = $(this).data("pdf_size");

      if (!location) return true;
      if (location) setLocation(location);

      setPdf(pdf, pdf_size)

      setAdditional(additional, additional_thumb);

      if (thumbIndex == undefined || isNaN(thumbIndex)) return true;

      // call the "goToSlide" public function
      slider.goToSlide(thumbIndex - 1);
      document.location.hash = "/" + (thumbIndex);
    
      // remove all active classes
      $('.slider-thumbs a').removeClass('pager-active');
      // assisgn "pager-active" to clicked thumb
      $(this).addClass('pager-active');
      // very important! you must kill the links default behavior
      return false;
    });

    // assign "pager-active" class to the first thumb
    $('.slider-thumbs a:first').addClass('pager-active');

    
    if($(location).attr("hash")) {
      var hash = $(location).attr("hash");
      var site_id_rgx = /#\/(\d+)/;
      var site_id = site_id_rgx.exec(hash)[1];
      $($('.slider-thumbs a')[site_id]).click();
      }

    });



  </script>
  <style>
    .slider-box {
      position: relative;
      overflow: hidden;

    }

    .slider-box ul {
        width: 20000em;
        position: absolute;
        list-style: none;
        margin: 0;
        padding: 0;
    }

    .slider-box li {
        float: left;
        }


    .slider-box {
      width: 826px;
    }

    .slider-box li {
      width: 826px;
    }

    .slider-box li figure {
    }

    .slider-box li figure img {
      border: solid 3px #303030;
    }

      .slider-thumbs {
      width: 826px;
      margin-top: 6px;
      margin-left: 16px;
      }

    .slider-thumbs img {
    border: solid 3px #303030;
    }

    #mainsection aside {
      left: 860px;
      top: 20px;
      position: absolute;
      width: 250px;
      height: 547px;
      z-index: 100;
    }

    #mainsection aside h1 {
    font-family: "arial";
    margin-bottom: 0.5em;
    color: #D6D6D6;
    font-size: 30px;
    }

    #mainsection aside img {
      margin-top: 6px;
    }

    #mainsection aside div {
    display: block;
    bottom: 0px;
    position: absolute;
    }

  </style>
---

<section id="mainsection">

<% # load elems
elems = YAML::load( File.open( 'includes/images.yaml' ) )
%>


<div class="slider-box">
  <ul id="slider">
    <%=
    elems.map do |elem|
    if elem["image"]
    %{ <li>
    <figure>
    <img src="#{elem["image"]}" data-imgid="#{elem["imgid"] || ''}" />
    </figure>
    </li> } + "\n"
    end
    end
    %>
  </ul>
</div>

<div class="slider-thumbs">
  <%= 
  elems.map do |elem|
  image = elem["thumb"] || elem["image"]
  link = elem["thumblink"] || '#'
  additional = if elem["additional"].is_a? Array
    elem["additional"].join(',')
  elsif elem["additional"].is_a? String
    elem["additional"]
  else
    ""
  end
  %{Â <a href="#{link}" data-refid="#{elem["imgid"] || ''}" data-location="#{elem["location"] || ''}" data-additional="#{additional}" data-additional_thumb="#{''}" data-pdf="#{elem["pdf"] || ''}" data-pdf_size="#{elem["pdf_size"] || ''}"><img src="#{image}" height="40" /></a> } + "\n"
  end
  %>
</div>

<aside id="slider-aside"><h1></h1><p></p>
<span class="slider-aside-image"></span></aside>

</section>

